<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Tracker</title>
    <link rel="stylesheet" href="style.css">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- html2canvas + jsPDF for PDF -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
</head>
<body>

<!-- Top-right Menu -->
<div class="menu-container">
    <button id="menu-btn">â˜° Reports</button>
    <div class="dropdown hidden">
        <button class="menu-item" data-type="daily">Daily Report</button>
        <button class="menu-item" data-type="weekly">Weekly Report</button>
        <button class="menu-item" data-type="monthly">Monthly Report</button>
    </div>
</div>

<h1>Daily Tracker</h1>
<div id="digital-clock"></div>

<!-- Daily Content Container -->
<div class="wrapper" id="day-content">
    <!-- Day content will load here via JS -->
</div>

<script src="script.js"></script>
<script>
/* =========================
   Load Daily Page Content
========================= */
function loadDailyPage() {
    const params = new URLSearchParams(window.location.search);
    const day = params.get('day') || 'mon';
    const daysData = ['mon','tue','wed','thu','fri','sat','sun'];
    const dayNames = ['Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sunday'];

    const container = document.getElementById('day-content');
    container.innerHTML = '';

    const idx = daysData.indexOf(day);
    const dayDiv = document.createElement('div');
    dayDiv.className = 'day';
    dayDiv.dataset.day = day;
    dayDiv.innerHTML = `
        <h2>${dayNames[idx]}</h2>
        <div class="task morning">
            ðŸŒž Morning Routine:
            <div class="morning-subtasks">
                <label><input type="checkbox" class="morning-checkbox"> Drink Water</label>
                <label><input type="checkbox" class="morning-checkbox"> Exercise</label>
                <label><input type="checkbox" class="morning-checkbox"> Meditation</label>
                <label><input type="checkbox" class="morning-checkbox"> Reading</label>
            </div>
            <canvas id="chart-${day}"></canvas>
        </div>
        <div class="task">ðŸ’» Work / Study <input type="checkbox" class="task-checkbox"></div>
        <div class="task">ðŸ‡³ðŸ‡± Dutch Course <input type="checkbox" class="task-checkbox"></div>
        <textarea class="note-text" placeholder="Notes / Reason"></textarea>
    `;
    container.appendChild(dayDiv);

    // Load from localStorage
    loadTemplate(dayDiv);

    // Morning Pie Chart
    const ctx = document.getElementById(`chart-${day}`).getContext('2d');
    const morningCheckboxes = [...dayDiv.querySelectorAll('.morning-checkbox')];
    function updateChart() {
        const done = morningCheckboxes.filter(cb => cb.checked).length;
        const remaining = morningCheckboxes.length - done;
        if(window.morningChart) window.morningChart.destroy();
        window.morningChart = new Chart(ctx, {
            type: 'pie',
            data: {
                labels: ['Done','Remaining'],
                datasets:[{
                    data:[done,remaining],
                    backgroundColor:['#0f4d0f','#555'],
                }]
            },
            options:{
                plugins:{
                    legend:{position:'bottom',labels:{color:'#fff'}},
                    tooltip:{enabled:true}
                }
            }
        });
    }
    updateChart();

    // Checkbox change listener
    morningCheckboxes.forEach(cb => {
        cb.addEventListener('change', ()=>{
            saveTemplate(dayDiv);
            updateChart();
        });
    });

    dayDiv.querySelectorAll('.task-checkbox').forEach(cb=>{
        cb.addEventListener('change', ()=>{
            saveTemplate(dayDiv);
        });
    });
    dayDiv.querySelector('.note-text').addEventListener('input',()=>{
        saveTemplate(dayDiv);
    });
}

document.addEventListener('DOMContentLoaded', ()=>{
    updateClock(); // Clock from script.js
    loadDailyPage();
});
</script>
</body>
</html>


