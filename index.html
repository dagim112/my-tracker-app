<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Study & Programming Tracker with Pie %</title>
<style>
body { font-family: Arial, sans-serif; background:#f0f0f0; padding:10px; }
h1 { text-align:center; margin-bottom:20px; }
.day-title { font-weight:bold; margin-top:15px; font-size:16px; }
.task { background:#fff; margin:5px 0; padding:10px; border-left:5px solid #4CAF50; border-radius:5px; cursor:pointer; }
.morning-container { display:flex; justify-content:space-between; align-items:flex-start; margin-top:5px; }
.morning-subtasks { display:flex; flex-direction:column; font-size:14px; }
.progress-container, .day-progress-container { margin:10px 0; background:#ddd; border-radius:5px; overflow:hidden; position:relative; }
.progress-bar, .day-progress-bar { height:20px; width:0%; background:#2196F3; text-align:center; color:white; line-height:20px; font-weight:bold; }
.day-progress-bar { height:15px; font-size:12px; line-height:15px; }
canvas { max-width:150px; max-height:150px; }
#start-sound { display:block; margin:15px auto; padding:10px 20px; font-size:16px; }
</style>
</head>
<body>

<h1>Study & Programming Tracker (Monâ€“Fri)</h1>

<div class="progress-container">
  <div class="progress-bar" id="weekly-progress">0%</div>
  <div class="goal-line" style="left:90%"></div>
</div>

<button id="start-sound">Start Hourly Voice Reminder</button>
<audio id="my-sound" src="your-voice.mp3" preload="auto"></audio>

<div class="days-container"></div>

<!-- Chart.js + DataLabels plugin -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>

<script>
// Generate days dynamically
const daysData = ['mon','tue','wed','thu','fri'];
const dayNames = ['Monday','Tuesday','Wednesday','Thursday','Friday'];
const container = document.querySelector('.days-container');

daysData.forEach((day, index) => {
  const dayDiv = document.createElement('div');
  dayDiv.className='day';
  dayDiv.dataset.day = day;
  dayDiv.innerHTML = `
  <div class="day-title">${dayNames[index]}</div>
  <div class="day-progress-container">
    <div class="day-progress-bar" id="progress-${day}">0%</div>
    <div class="day-goal-line" style="left:80%"></div>
  </div>

  <!-- Morning Routine -->
  <div class="task morning">
    <span class="morning-title">ðŸŒž Morning Routine (6:00â€“8:00)</span>
    <div class="morning-container" style="display:none;">
      <div class="morning-subtasks">
        <label><input type="checkbox" class="morning-checkbox"> Drink Water</label>
        <label><input type="checkbox" class="morning-checkbox"> Prayer / Meditation</label>
        <label><input type="checkbox" class="morning-checkbox"> Visualization</label>
        <label><input type="checkbox" class="morning-checkbox"> Exercise / Stretch</label>
        <label><input type="checkbox" class="morning-checkbox"> Healthy Breakfast</label>
        <label><input type="checkbox" class="morning-checkbox"> Reading / Learning</label>
        <label><input type="checkbox" class="morning-checkbox"> Journaling</label>
      </div>
      <canvas id="morningChart-${day}"></canvas>
    </div>
  </div>

  <!-- Programming / HackYourFuture Prep -->
  <div class="task">8:00â€“12:00 ðŸ’» Programming Practice / HackYourFuture Prep
    <input type="checkbox" class="task-checkbox">
  </div>

  <!-- Dutch Course -->
  <div class="task">12:00â€“16:30 ðŸ‡³ðŸ‡± Dutch Course
    <input type="checkbox" class="task-checkbox">
  </div>

  <!-- Review / Light Coding -->
  <div class="task">16:30â€“17:30 ðŸ’» Review & Light Coding
    <input type="checkbox" class="task-checkbox">
  </div>
  `;
  container.appendChild(dayDiv);
});

// Toggle morning routine display
document.addEventListener('click', function(e){
  if(e.target.classList.contains('morning-title')){
    const container = e.target.nextElementSibling;
    container.style.display = container.style.display==='none'?'flex':'none';
  }
});

// Initialize charts for each day
const morningCharts = {};
document.querySelectorAll('.day').forEach(day => {
  const ctx = day.querySelector('canvas').getContext('2d');
  morningCharts[day.dataset.day] = new Chart(ctx,{
    type:'doughnut',
    data:{
      labels:['Completed','Remaining'],
      datasets:[{data:[0,7], backgroundColor:['#4CAF50','#ddd'], borderWidth:1}]
    },
    options:{
      responsive:true,
      plugins:{
        legend:{display:true,position:'bottom'},
        datalabels:{
          formatter: (value, ctx) => {
            const total = ctx.chart.data.datasets[0].data.reduce((a,b)=>a+b,0);
            const percent = Math.round((value/total)*100);
            return ctx.dataIndex === 0 ? percent+'%' : '';
          },
          color:'#fff',
          font:{weight:'bold', size:14}
        },
        title:{display:true,text:'Morning Progress',font:{size:14}}
      }
    },
    plugins:[ChartDataLabels]
  });
});

// Save/load state
function saveState(){
  document.querySelectorAll('.morning-checkbox, .task-checkbox').forEach(cb=>{
    const id = cb.closest('.day').dataset.day + '-' + cb.parentElement.innerText.trim();
    localStorage.setItem(id, cb.checked);
  });
}
function loadState(){
  document.querySelectorAll('.morning-checkbox, .task-checkbox').forEach(cb=>{
    const id = cb.closest('.day').dataset.day + '-' + cb.parentElement.innerText.trim();
    const saved = localStorage.getItem(id);
    if(saved==='true') cb.checked=true;
  });
}

// Update morning chart and return fraction for daily %
function updateMorningChart(day){
  const chart = morningCharts[day.dataset.day];
  const checkboxes = day.querySelectorAll('.morning-checkbox');
  const completed = Array.from(checkboxes).filter(cb=>cb.checked).length;
  const total = checkboxes.length;
  chart.data.datasets[0].data=[completed,total-completed];
  chart.update();
  return completed/total;
}

// Update daily and weekly progress
function updateProgress(){
  const days = document.querySelectorAll('.day');
  let totalTasks=0, totalCompleted=0;
  days.forEach(day=>{
    const morningFraction = updateMorningChart(day);
    const morningWeight = 1;
    const morningCompleted = morningFraction*morningWeight;
    const otherTasks = day.querySelectorAll('.task-checkbox');
    const totalDayTasks = morningWeight + otherTasks.length;
    const completedDayTasks = morningCompleted + Array.from(otherTasks).filter(cb=>cb.checked).length;
    const dailyPercent = Math.round((completedDayTasks/totalDayTasks)*100);
    const dailyBar = day.querySelector('.day-progress-bar');
    dailyBar.style.width=dailyPercent+'%';
    dailyBar.innerText=`${dailyPercent}% (Goal: 80%)`;
    dailyBar.style.background=dailyPercent>=80?'#4CAF50':'#2196F3';
    totalTasks+=totalDayTasks;
    totalCompleted+=completedDayTasks;
  });
  const weeklyPercent=Math.round((totalCompleted/totalTasks)*100);
  const weeklyBar=document.getElementById('weekly-progress');
  weeklyBar.style.width=weeklyPercent+'%';
  weeklyBar.innerText=`${weeklyPercent}% (Goal: 90%)`;
  weeklyBar.style.background=weeklyPercent>=90?'#4CAF50':'#2196F3';
}

// Checkbox events
document.addEventListener('change', e=>{
  if(e.target.classList.contains('morning-checkbox')||e.target.classList.contains('task-checkbox')){
    saveState();
    updateProgress();
  }
});

// Initialize
loadState();
updateProgress();

// Hourly voice reminder
const audio=document.getElementById('my-sound');
const button=document.getElementById('start-sound');
let timer;
button.addEventListener('click',()=>{
  audio.play().catch(e=>console.log(e));
  timer=setInterval(()=>{audio.play().catch(e=>console.log(e));},3600000);
  alert('Hourly voice reminders started!');
});
</script>

</body>
</html>
